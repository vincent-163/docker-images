FROM archlinux:latest
RUN pacman -Syu --needed --noconfirm --noprogressbar git base base-devel sudo
RUN useradd -ms /bin/bash user && groupadd sudo && usermod -aG sudo user && \
    echo '%sudo ALL=(ALL:ALL) NOPASSWD: ALL' > /etc/sudoers.d/50-sudo-nopasswd
RUN echo '[archlinuxcn]'"\n"'Server = https://repo.archlinuxcn.org/$arch' >> /etc/pacman.conf && \
    pacman -Syu --noconfirm --noprogressbar archlinuxcn-keyring && \
    pacman -Syu yay
